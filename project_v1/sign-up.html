<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, width=device-width" />
    <link rel="stylesheet" href="./global.css" />
    <link rel="stylesheet" href="./sign-up.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap"
    />
  </head>
  <body>
    <div class="sign-up">
      <div class="frame988">
        <div class="frame989">
          <div class="frame990">
            <b class="text521">CSPFT를 시작해보세요!</b>
          </div>
          <div class="text522">CSPFT는 무료 체력시험 준비 플랫폼입니다</div>
        </div>
        <div class="frame991">
          
          <div class="frame993">
            <div class="frame994">
              <div class="frame995">
                <div class="text524">이름</div>
                <div class="name">
                  <input type="text" id="name" class="text_input" placeholder="Name">
                </div>
                <div>결과: <span id="name_check"></span></div>
              </div>
            </div>
            <div class="frame1349">
              <div class="text726">성별</div>
              <div class="check-cir1">
                  <div class="controlsvariant43">
                    <div class="frame1362">

                    </div>
                  </div>
                  <div class="text727">남성</div>
                </div>
                <div class="check-cir1">
                  <div class="controlsvariant33">
                    <div class="frame1363">

                    </div>
                  </div>
                  <div class="text728">여성</div>
                </div>
            </div>
            
            
            
            
          </div>

          <div class="frame1007">
            <div class="frame995">
              <div class="text524">이메일 주소</div>
              <div class="name">
                <input type="text" id="email" class="text_input" placeholder="Email 입력하기" />


              </div>
              <div>결과: <span id="mergedEmail"></span></div>
            </div>
            <div class="text535">올바르지 않는 이메일 주소 형식입니다.</div>
          </div>
          <div class="frame1009">
            <div class="frame995">
              <div class="text524">비밀번호</div>
              <div class="weight">
                <input type="password" id="password1" class="text_input" placeholder="Password" />
                  <img
                    class="frame-icon48 password-toggle"
                    alt=""
                    src="./public/1256-frame.svg"
                    onclick="togglePasswordVisibility('password1')"
                  />
              </div>
              <div>결과: <span id="password_result"></span></div>
            </div>

          </div>
          <div class="frame1011">
            <div class="frame995">
              <div class="text524">비밀번호 확인</div>
              <div class="weight">
                <input type="password" id="password2" class="text_input" placeholder="Password" />
                  <img
                    class="frame-icon48 password-toggle"
                    alt=""
                    src="./public/1256-frame.svg"
                    onclick="togglePasswordVisibility('password2')"
                  />
              </div>
              <div>결과: <span id="password_result2"></span></div>
            </div>
            <div class="text535">비밀번호가 일치하지 않습니다.</div>
          </div>
          <div class="application1">
            <div class="frame1318 dropdown">
              <div class="menu-text">
                <div class="text704">희망 지망 직렬 선택</div>
                <img class="frame-icon75" alt="" src="./public/496-frame.svg" />
              </div>
              <div class="dropdown-content">
                <a href="#">옵션 1</a>
                <a href="#">옵션 2</a>
                <a href="#">옵션 3</a>
                <a href="#">옵션 4</a>
                <a href="#">옵션 5</a>
                <a href="#">옵션 6</a>
              </div>
            </div>
          </div>
          


          <div class="frame1013">
            <div class="check-box">
            
            </div>
            <div class="text527">개인정보 이용에 동의합니다</div>
          </div>
          <div class="frame1014">
            <div class="generate-account-button">
              <div class="frame1015">
                <div class="text543">계정 생성하기</div>
              </div>
            </div>
          </div>
          
        </div>
        <div class="line"></div>
        <div class="sign-in" id="signInText">이미 계정이 있으십니까?</div>
      </div>
    </div>

    <script>


      var validDomains = ['naver.com', 'google.com', 'daum.net'];

      var emailInput = document.getElementById("email"); // 변경된 이메일 입력 요소 가져오기
      var mergedEmailResult = document.getElementById("mergedEmail");
      var mail_result = 0

      emailInput.addEventListener("input", updateMergedEmail);

      function updateMergedEmail() {
        var email = emailInput.value;
        var errorMessage = '';
        var regex = /^[a-z0-9]+$/i;  // 대소문자 구분 없이 검사하는 정규식

        if (!email) {
          errorMessage = "이메일을 입력하세요.";
        } else if (!email.includes("@")) {
          errorMessage = "올바른 이메일 주소를 입력하세요.";
        } else {
          var parts = email.split("@");
          var emailFront = parts[0];
          var emailAfterAt = parts[1];

          if (!regex.test(emailFront)) {
            errorMessage = "올바른 이메일 앞 부분을 입력하세요.";
          } else if (!isValidDomain(emailAfterAt)) {
            errorMessage = "올바른 도메인 주소를 입력하세요.";
          } else if (!isValidDomainInList(emailAfterAt)) {
            errorMessage = "지원하지 않는 도메인 주소입니다.";
          }
        }

        if (errorMessage) {
          mergedEmailResult.textContent = errorMessage;
        } else {
          mergedEmailResult.textContent = emailFront + "@" + emailAfterAt;
          mail_result=1
        }
      }

      function isValidDomain(domain) {
        return validDomains.includes(domain);
      }

      function isValidDomainInList(domain) {
        return validDomains.includes(domain);
      }

  






      document.addEventListener("DOMContentLoaded", function () {
        var nameInput = document.getElementById("name");
        var nameCheckResult = document.getElementById("name_check");
        var name_result = 0
        var password2_result=0

        nameInput.addEventListener("input", function () {
          var name = nameInput.value;

          if (/[!@#$%^&*()_+{}\[\]:;<>,.?~\\/`'" ]/.test(name)) {
            nameCheckResult.textContent = "특수 문자 또는 공백은 입력할 수 없습니다.";
          } else if (!/^[가-힣]+$/.test(name)) {
            nameCheckResult.textContent = "한글만 입력 가능합니다.";
          } else if (name.length < 2 || name.length > 4) {
            nameCheckResult.textContent = "이름은 2글자 이상, 4글자 이하로 입력해주세요.";
          } else {
            nameCheckResult.textContent = "올바른 이름입니다.";
            name_result=1
          }
        });

        var passwordInput = document.getElementById("password1");
      var passwordInput2 = document.getElementById("password2");
      var passwordResult = document.getElementById("password_result");
      var passwordResult2 = document.getElementById("password_result2");

      passwordInput.addEventListener("input", checkPasswordValidity);

      function checkPasswordValidity() {
        var password = passwordInput.value;
        var errorMessage = '';

        var lengthRegex = /^.{9,16}$/;
        var alphanumericRegex = /^(?=.*[a-zA-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]+$/;
        var nameCheck = true;
        var pastPasswordsCheck = true;
        var password_result=0

        if (!lengthRegex.test(password)) {
          errorMessage = "비밀번호는 9자 이상 16자 이하로 입력하세요.";
        } else if (!alphanumericRegex.test(password)) {
          errorMessage = "비밀번호는 영어, 숫자, 특수문자를 모두 포함해야 합니다.";
        } else if (!nameCheck) {
          errorMessage = "비밀번호에 사용자 이름이 포함되어 있습니다.";
        } else if (!pastPasswordsCheck) {
          errorMessage = "비밀번호가 과거에 사용된 적이 있습니다.";
        }

        passwordResult.textContent = errorMessage || "비밀번호가 유효합니다.";

        if (!errorMessage) {
          passwordInput2.addEventListener("input", checkPasswordMatch);
          password_result=1
        } else {
          passwordResult2.textContent = ""; // 에러 메시지가 있는 경우 초기화
        }
      }

      function checkPasswordMatch() {
        var password1 = passwordInput.value;
        var password2 = passwordInput2.value;
        

        if (password1 === password2) {
          passwordResult2.textContent = passwordResult.textContent;
          password2_result=1
        } else {
          passwordResult2.textContent = "비밀번호가 일치하지 않습니다.";
        }
      }
      var dropdown = document.querySelector(".dropdown");
      var dropdownText = dropdown.querySelector(".text704");
      var dropdownContent = dropdown.querySelector(".dropdown-content");
      var selectedOption = null;
      var genderMale = document.querySelector(".controlsvariant43");
      var genderFemale = document.querySelector(".controlsvariant33");
    
      dropdownText.addEventListener("click", function () {
        dropdown.classList.toggle("active");
      });
    
      // Function to attach event listeners to the options
      function attachOptionListeners() {
        var options = document.querySelectorAll(".dropdown-content a");
        options.forEach(function (option) {
          option.addEventListener("click", function (event) {
            event.preventDefault();
            selectedOption = option.textContent;
            dropdownText.textContent = selectedOption;
            dropdown.classList.remove("active");
          });
        });
      }
    
      genderMale.addEventListener("click", function () {
        dropdownContent.innerHTML = `
          <a href="#">옵션 1</a>
          <a href="#">옵션 2</a>
          <a href="#">옵션 3</a>
        `;
        attachOptionListeners(); // Attach event listeners to the new options
      });
    
      genderFemale.addEventListener("click", function () {
        dropdownContent.innerHTML = `
          <a href="#">옵션 4</a>
          <a href="#">옵션 5</a>
          <a href="#">옵션 6</a>
        `;
        attachOptionListeners(); // Attach event listeners to the new options
      });
    
      attachOptionListeners(); // Attach event listeners to the initial options
    
      window.addEventListener("click", function (event) {
        if (!dropdown.contains(event.target)) {
          dropdown.classList.remove("active");
        }
      });


      var generateAccountButton = document.querySelector(".generate-account-button");
      generateAccountButton.addEventListener("click", function () {
        var nameInputValue = ""
        if (name_result){
          nameInputValue = nameInput.value; 

        }
        var emailInputValue = ""
        if (mail_result){
          emailInputValue=emailInput.value; // Get the value from the email input

        }

        var password1InputValue =""
        if (password_result){
          password1InputValue =passwordInput.value; // Get the value from the first password input

        }

        var password2InputValue = ""
        if(password2_result){
          password2InputValue =passwordInput2.value; // Get the value from the second password input

        }  
        var checkBoxSelected = check_box.classList.contains("selected_box");
        var selectedOption = dropdownText.textContent;


        console.log("이름 입력 값:", nameInputValue);
        console.log("이메일 입력 값:", emailInputValue);
        console.log("비밀번호 입력 값:", password1InputValue);
        console.log("비밀번호 확인 입력 값:", password2InputValue);
        console.log("개인정보 이용 동의 여부:", checkBoxSelected);
        console.log("희망 지망 직렬 선택:", selectedOption);

        
        // 추가적인 처리나 서버로의 전송 등을 수행할 수 있습니다.
      });
    });
      
      
      var ellipse6 = document.querySelector(".frame1362");
      var ellipse7 = document.querySelector(".frame1363");
    
      ellipse6.addEventListener("click", function () {
        ellipse6.classList.add("selected");
        ellipse7.classList.remove("selected");
      });
    
      ellipse7.addEventListener("click", function () {
        ellipse7.classList.add("selected");
        ellipse6.classList.remove("selected");
      });
    
      // 초기 상태 설정
      ellipse6.classList.remove("selected");
      ellipse7.classList.remove("selected");
  
      var check_box = document.querySelector(".check-box");
      check_box.addEventListener("click", function () {
        check_box.classList.toggle("selected_box");
      });




      function togglePasswordVisibility(inputElementId) {
        var passwordInput = document.getElementById(inputElementId);
        if (passwordInput.type === "password") {
          passwordInput.type = "text";
        } else {
          passwordInput.type = "password";
        }
      }
      var signInText = document.getElementById("signInText");
      if (signInText) {
        signInText.addEventListener("click", function (e) {
          window.location.href = "./sign-in.html";
        });
      }



      </script>
  </body>
</html>
