<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, width=device-width" />
    <link rel="stylesheet" href="./global.css" />
    <link rel="stylesheet" href="./reset-password.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap"
    />
  </head>
  <body>
    <div class="reset-password">
      <div class="frame979">
        <div class="frame980">
          <div class="frame981">
            <b class="text515">비밀번호를 잊으셨습니까?</b>
          </div>
          <div class="text516">
            등록하신 이메일 주소로 임시 비밀번호를 발급해드리겠습니다.
          </div>
        </div>
        <div class="frame982">
          <div class="frame983">
            <div class="frame984">
              <div class="text517">이메일 주소</div>
              <div class="frame985">

                <input type="text" id="emailFront" class="text123" placeholder="Email 앞 부분" />
                @
                <input type="text" id="emailAfterAt" class="text123" placeholder="직접입력하기" />
            

              </div>
              <div>결과: <span id="mergedEmail"></span></div>
            </div>
            <div class="text519">올바르지 않는 이메일 주소 형식입니다.</div>
          </div>
          <div class="frame986"id="sendEmail">
              <div class="text520">인증번호 전송</div>
          </div>
        </div>
      </div>
    </div>

  <script>
    var validDomains = ['naver.com', 'google.com', 'daum.net'];

    var emailFrontInput = document.getElementById("emailFront");
    var emailAfterAtInput = document.getElementById("emailAfterAt");
    var mergedEmailResult = document.getElementById("mergedEmail");

    emailFrontInput.addEventListener("input", updateMergedEmail);
    emailAfterAtInput.addEventListener("input", updateMergedEmail);

    function updateMergedEmail() {
      var emailFront = emailFrontInput.value;
      var emailAfterAt = emailAfterAtInput.value;
      var errorMessage = '';

      if (!emailFront || !emailAfterAt) {
        errorMessage = "이메일 앞과 @ 이후의 부분을 모두 입력하세요.";
      } else if (emailFront.includes(" ") || emailFront.includes("@")) {
        errorMessage = "올바른 이메일 앞 부분을 입력하세요.";
      } else if (!isValidDomain(emailAfterAt)) {
        errorMessage = "올바른 도메인 주소를 입력하세요.";
      } else if (!isValidDomainInList(emailAfterAt)) {
        errorMessage = "지원하지 않는 도메인 주소입니다.";
      }

      if (errorMessage) {
        mergedEmailResult.textContent = errorMessage;
      } else {
        mergedEmailResult.textContent = emailFront + "@" + emailAfterAt;
      }
    }

    function isValidDomain(domain) {
      return validDomains.includes(domain);
    }

    function isValidDomainInList(domain) {
      return validDomains.includes(domain);
    }

    function getCookieValue(name) {
    var cookieValue = "";
    var cookies = document.cookie.split("; ");
    for (var i = 0; i < cookies.length; i++) {
      var cookie = cookies[i].split("=");
      if (cookie[0] === name) {
        cookieValue = decodeURIComponent(cookie[1]);
        break;
      }
    }
    return cookieValue;
  }


    var sendEmail = document.getElementById("sendEmail");
    if (sendEmail) {
      sendEmail.addEventListener("click", function (e) {
      updateMergedEmail();

      var mergedEmail = mergedEmailResult.textContent; // 업데이트된 값 읽어오기
      console.log("!!!",mergedEmail);
      console.log(mergedEmail);

      document.cookie = "userEmail=" + encodeURIComponent(mergedEmail);
      console.log("!!!쿠키", document.cookie);

      //window.location.href = "./reset-password-auth.html";
      });
    }

  </script>
  </body>
</html>
